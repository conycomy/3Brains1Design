# 객체지향의 사실과 오해 4장

## 목표

책에서 다룬 추상적인 내용을 코드레벨에서 직접 적용해보고 더욱 구체적으로 이해하기 위해서 간단한 도서관 시스템을 구축하였음.
역할, 책임, 협력의 관점에서 코드를 짜는 능력을 기르고, 설계 능력을 기르는 것을 목표로 함.

## 시나리오

```
1. 회원이 사서에게 책 대여를 요청한다.
2. 사서는 도서 목록에서 해당 도서가 있는지 확인한다.
3. 도서가 있으면 대여를 진행하고 대여 기록에 저장한다.
4. 사서는 도서 정보를 회원에게 응답한다.
```

## 구현 방향

1. 시스템의 흐름을 텍스트로 서술하고 응답과 요청으로 협력을 도출
2. 협력과정에서 필요한 책임을 식별
3. 책임을 객체에 할당
4. 비슷한 책임을 역할로 할당

## 구현 과정

- 멤버는 기능이 따로 추가되지 않을 것이며, 항상 같은 일을 수행할 것이기 때문에 인터페이스가 아닌 하나의 클래스로 고정하였음.
- 사서는 DB와 model.Member 중간에서 Controller의 역할을 함.
- DB는 InMemory의 역할만 수행하도록 하였음. 추후 다른 데이터 구조를 추가해서 처리해볼 예정
- 사서, 대여이력, 카탈로그는 모두 다른 객체가 대체할 가능성이 있다고 판단하여 인터페이스화 하였음
  (Ex_사서를 관리자가 대체한다던가,InMemory를 File로 대체한다던가 하는 경우의 변경의 파급효과를 최소화 하기 위함임.)
- 추가적으로 책을 대여할 때는 책의 이름과 개수를 말하도록 하였음. 이를 Map<Book, Integer>로 처리하였으나, 더 나은 선택지가 있을 것이라고 생각함.
  이로 인해서 코드가 복잡해지고 직관적이지 않게 되었다고 생각함. 조금 더 깔끔하게 하나의 DTO를 통해 처리하면 깔끔하지 않았을까 싶음.

## 구현 과정에서의 고찰

처음부터 완벽한 설계를 하는 것은 어렵지만, 설계를 완벽하게 하고싶다는 마음가짐 때문에 빠른 개발이 되지 않는 문제가 발생하였음.
또한, 이번 과정에서는 코드리뷰의 수월함을 위해서 책임과 역할이 주어졌으나, 오히려 이 지점 때문에 설계를 하는 과정에서
어려움이 많이 발생하였던 것 같음.
<br/>

가장 중요한 것은 책임이라는 것을 깨달았음. 책임이 명확하면 이를 메시지로 구체화하기가 매우 수월하고,
동일한 메시지를 수행할 수 있는 객체들을 모아 하나의 역할로 추상화하기 매우 수월하다는 사실을 깨달았음.
<br/>

프로그래밍의 관점에서 인터페이스화 하는 이유를 알 수 없었지만,
인터페이스를 사용하여서 비슷한 책임을 가질 수 있는 객체가 여러개 존재할 수 있으며,
하나의 역할을 여러 객체가 대체할 수 있는 경우에 인터페이스를 사용하면 OCP, DIP, LSP를 충족시켜서
변경에 강한 코드가 저절로 만들어진다는 것을 알 수 있었다.
<br/>

책임이 공용 인터페이스라는 말이 이해가 가지 않았지만, 직접 구현해보면서 알 수 있었다.
이는 객체가 수행해야 할 책임들이 곧 외부에게 제공되어야 하는 서비스이다.
이 내부 구현부에 대해서는 외부에서는 전혀 알 수 없다.
이렇게 캡슐화를 진행함으로서 결합도가 낮아진다는 것을 체감할 수 있었다.
<br/>

구현하고 보니 MVC 패턴과 동일한 양상을 띄는 형태의 구조가 만들어졌다.
결국 MVC 패턴 자체가 객체들의 협력을 극대화시켜줄 수 있는 방법의 구조라는 것을 알 수 있었다.
<br/>

Map과 List를 사용하고 DTO 객체를 사용하기 때문에 stream의 중요성을 더욱 실감하였음
실무의 코드를 잠깐 본 적이 있었는데 stream을 정말 많이 사용했던 것을 알 수 있었음.
stream을 통해서 여러 데이터구조를 편리하고 빠르게 수정 및 조회할 수 있어야 함을 깨달았음.
<br/>

코드를 작성하고 끝내는 것이 아닌, 기존의 코드를 게속해서 개선할 수 있어야함을 깨달았음.
코드가 지저분하고 냄새하는 코드가 많음. 조금 더 깔끔하게 추상화하고, 직관적으로 리펙토링을 해야함을 깨달았음.
